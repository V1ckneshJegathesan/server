CREATE DATABASE clx;
USE clx;

DROP TABLE IF EXISTS cx1;
CREATE TABLE cx1(i BIGINT)ENGINE=clustrixdb;
--error ER_TABLE_EXISTS_ERROR
CREATE TABLE cx1(i BIGINT)ENGINE=clustrixdb;

INSERT INTO cx1 VALUES (42);

SELECT * FROM cx1;

DROP TABLE cx1;

--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE cx1;

DROP TABLE IF EXISTS intandtext;
CREATE TABLE intandtext(i bigint, t text)ENGINE=clustrixdb;
INSERT INTO intandtext VALUES(10, 'someqwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq');

SELECT i,t FROM intandtext;
EXPLAIN SELECT i,t FROM intandtext;

SET @@optimizer_switch='derived_merge=OFF';
SET clustrixdb_select_handler=OFF;
SELECT i,t FROM (SELECT i,t FROM intandtext) t;
EXPLAIN SELECT i,t FROM (SELECT i,t FROM intandtext) t;

SET clustrixdb_derived_handler=OFF;
SELECT i,t FROM intandtext;
SELECT i,t FROM (SELECT i,t FROM intandtext) t;
EXPLAIN SELECT i,t FROM (SELECT i,t FROM intandtext) t;

DROP TABLE intandtext;

USE test;
DROP DATABASE clx;
